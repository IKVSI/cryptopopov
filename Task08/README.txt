# Task08: Анонимная подпись чека в банке со скрытым ID

Реализация протокола электронных денег с подписью чека в банке без ID

## Описание протокола

    1) Алиса отправляет Банку N конвертов с зашифрованным ID и суммой
    2) Банк просит Алису вскрыть N-1 конверт
    3) Алиса вскрывает конверты (снимает шифр) банк видит одинаковую сумму на каждом из них,
    чем больше конвертов, тем лучше Банку.
    4) Банк подписывает последний конверт и возвращает Алисе
    5) Алиса снимает шифр с конверта и достаёт подписаный чек, отдаёт его продавцу
    6) Продавец проверяет подпись банка и если всё ок, позже обналичивает чек.


## Использование

Это приложение использует модуль multiprocessing для создания отдельных процессов.
Алиса, Банк и Продавец и др. вынесены в отдельные процессы и организованна передача данных
между ними. Тем самым можно считать их отдельными приложениями(форками).
Пользователю предлагается определить количество чеков для того чтобы банк подписал 1 из них.
Также можно посмотреть просты сценарии с подделкой чека, данных чека или даже попробовать
заставить банк случайно подписать чек (пример такого исхода в файле fakeamount.txt)
Алиса отправляет банку N чеков, банк вскрывает N-1, один подписывает PSS подписью, Продавец проверяет подпись

### Help программы:

usage: main.py [-h] [-amount AMOUNT] [-fakesign] [-fakedata] count

Программа подписи чека в банке с анонимным ID конверты

positional arguments:
  count           Количество чеков для отправки банку (Степень доверия)

optional arguments:
  -h, --help      show this help message and exit
  -amount AMOUNT  Запуск программы с попыткой подделать 1 чек другой суммой (в
                  чеках сумма 1000)
  -fakesign       Пробуем подставить подпись в другой чек
  -fakedata       Пробуем подставить другие данные в чек

## Примеры работы

Для удобства есть сценарий:

execute.bat
--------------------------------------------------------------------------------
@ECHO OFF
python main.py 100
PAUSE
--------------------------------------------------------------------------------

### Логи Программы: test.file

Полные логи можно посмотреть в файле test.file
тут же представлено согласование 2 битов информации
.................

------------------------------------------------------------
Alice  : Получен номер 9 чека для проверки суммы
Bank   : Получена гамма для чека номер 9
Bank   : Конверт открыт
Bank   : Чек проверен
 ------------------------------------------------------- 
|  Check  ID : 17479a1130c9b873cbb2de4eb50b864e         |
|  Amount    : 1000 $                                   |
|  Data hash : 0bdec4d1486e94736b53f739c3f323efecae045f |
|  Date/Time : None                                     |
|  Signature : None                                     |
 ------------------------------------------------------- 

------------------------------------------------------------
Alice  : Получен номер 10 чека для проверки суммы
Bank   : Получена гамма для чека номер 10
Bank   : Конверт открыт
Bank   : Чек проверен
 ------------------------------------------------------- 
|  Check  ID : 47381a762f27e4c05facfb9db68762a4         |
|  Amount    : 1000 $                                   |
|  Data hash : 965525cbecce6ab9674a3c62bce46ece639e2898 |
|  Date/Time : None                                     |
|  Signature : None                                     |
 ------------------------------------------------------- 

------------------------------------------------------------
Bank   : Чек номер 8 подписан банком и отправлен
 ------------------------------------------------------- 
|  Check  ID : None                                     |
|  Amount    : None $                                   |
|  Data hash : 6b47e59f77cf41a008430b9e9016b5ea957b1c47 |
|  Date/Time : 2019-01-27 07:01                         |
|  Signature : 4d1cc65e7a9e26fef42e1d8fff7a460c0470eb62 |
|              d810e513e7a07684354cdea07af535c2b45586f5 |
|              934c057b85f99d9b810e2468693289de114568be |
|              889c05b22ddb7af22301a7218cbfae24e74ce08f |
|              d66ef99fdbf91aaf22b3b0713fa6dea552aef02a |
|              92f4bd80f612d295b412a7d6d40635a79602e8dd |
|              9628714bc535075b                         |
 ------------------------------------------------------- 

------------------------------------------------------------
Alice  : Получен чек подписанный банком
Alice  : Расшифровываем конверт
Alice  : Конверт открыт
 ------------------------------------------------------- 
|  Check  ID : 82201c71dd050643beb153312bcfec9c         |
|  Amount    : 1000 $                                   |
|  Data hash : 6b47e59f77cf41a008430b9e9016b5ea957b1c47 |
|  Date/Time : 2019-01-27 07:01                         |
|  Signature : 4d1cc65e7a9e26fef42e1d8fff7a460c0470eb62 |
|              d810e513e7a07684354cdea07af535c2b45586f5 |
|              934c057b85f99d9b810e2468693289de114568be |
|              889c05b22ddb7af22301a7218cbfae24e74ce08f |
|              d66ef99fdbf91aaf22b3b0713fa6dea552aef02a |
|              92f4bd80f612d295b412a7d6d40635a79602e8dd |
|              9628714bc535075b                         |
 ------------------------------------------------------- 

Alice  : Отправляем чек продавцу
Charlie: Получен чек
Проверяем целостость данных
  datahash       : 6b47e59f77cf41a008430b9e9016b5ea957b1c47
  check.datahash : 6b47e59f77cf41a008430b9e9016b5ea957b1c47
Charlie: Проверяем подпись банка
Charlie: Подпись проверена открытым ключом Банка, чек корректный

## Дополнительные зависимости

module Cryptodome
    можно установить командой (от администратора) pip3 install pycryptodomex
также этот сценарий лежит в файле dependencies.bat

## Кластер

Windows 10 Home Russian Версия 1809
Python 3.7.2 32bit
12GB RAM
Intel Core I7-4710MQ 2.50Ghz


## Автор

Кулаков Владислав Сергеевич КБ-501 © 2019

