# Task01: Протокол Шамира

Реализация протокола Шамира между двумя экземплярами программы соединёнными через сокеты.

## Использование

Это клиент-серверное приложение, в качестве сервера выступает Боб.
Вначале запускаем Боба c ключом -s, потом Алису c секретным сообщением.
Без указания простого числа оно будет генерироваться в диапазоне [500, 1000].
Можно указать своё простое число (не желательно очень большое, программа для ознакомления).
Можно указать диапазон используя комбинацию ключей [-prime, -primeend]
Можно прописать свои интерфейсы host, port и запускать на разных компьютерах по сети.

Help программы:

usage: main.py [-h] [-s] [-port PORT] [-host HOST] [-prime PRIME]
               [-primeend PRIMEEND] [-p]
               [message [message ...]]

Программа для ознакомления с работой протокола Шамира

positional arguments:
  message             Сообщения используют однобайтовую кодировку (cp866)

optional arguments:
  -h, --help          show this help message and exit
  -s                  Запуск сервера Bob
  -port PORT          Порт для соединения или сервера
  -host HOST          Адрес подключения или сервера
  -prime PRIME        Установить своё простое число для сообщения
  -primeend PRIMEEND  Если установлено это число, то простое будет взято из
                      диапазона [prime, primeend]
  -p                  Пауза в конце программы

## Примеры работы

Для удобства есть 3 сценария:

execute.bat
--------------------------------------------------------------------------------
@ECHO OFF
TITLE BOB
START /B python main.py -s
START "ALICE" python main.py Secret message -prime 16769023
--------------------------------------------------------------------------------

execute1.bat
--------------------------------------------------------------------------------
@ECHO OFF
TITLE BOB
START /B python main.py -s
START "ALICE" python main.py Hello my friend!
--------------------------------------------------------------------------------

execute2.bat
--------------------------------------------------------------------------------
@ECHO OFF
TITLE BOB
START /B python main.py -s
START "ALICE" python main.py Hello my friend! -prime 100000 -primeend 1000000
--------------------------------------------------------------------------------

### Логи Алисы: alice.file

Alice: Bob подключён на host=127.0.0.1, port=9999
Alice: Сгенерированно простое число для обмена сообщением p=819739
Alice: Простое число p=819739 отправленно Bob-у
--------------------------------------------------------------------------------
Alice: 1 блок: Преобразуем "Se" в число M = 25939
Alice: 1 блок: Генерируем Ea=187367, Da=41681 Ea*Da = 1 (mod p-1)
Alice: 1 шаг (1 блок): Отправляем M^Ea = 710273 (mod p)
Alice: 2 шаг (1 блок): Получаем M^Ea^Eb = 38836 (mod p)
Alice: 3 шаг (1 блок): Отправляем M^Ea^Eb^Da = M^Eb = 736896 (mod p)
Alice: Закончена обработка 1 блока
--------------------------------------------------------------------------------
Alice: 2 блок: Преобразуем "cr" в число M = 29283
Alice: 2 блок: Генерируем Ea=61669, Da=9451 Ea*Da = 1 (mod p-1)
Alice: 1 шаг (2 блок): Отправляем M^Ea = 615155 (mod p)
Alice: 2 шаг (2 блок): Получаем M^Ea^Eb = 380094 (mod p)
Alice: 3 шаг (2 блок): Отправляем M^Ea^Eb^Da = M^Eb = 3710 (mod p)
Alice: Закончена обработка 2 блока
--------------------------------------------------------------------------------
Alice: 3 блок: Преобразуем "et" в число M = 29797
Alice: 3 блок: Генерируем Ea=76297, Da=787291 Ea*Da = 1 (mod p-1)
Alice: 1 шаг (3 блок): Отправляем M^Ea = 112819 (mod p)
Alice: 2 шаг (3 блок): Получаем M^Ea^Eb = 775152 (mod p)
Alice: 3 шаг (3 блок): Отправляем M^Ea^Eb^Da = M^Eb = 736285 (mod p)
Alice: Закончена обработка 3 блока
--------------------------------------------------------------------------------
Alice: 4 блок: Преобразуем "

### Логи Боба: bob.file
Bob: Ожидание подключения от Alice на host=127.0.0.1 port=9999
Bob: Alice подключена на host=127.0.0.1, port=9999
Bob: Простое число prime=819739 получено
--------------------------------------------------------------------------------
Bob: 1 блок: Генерируем Eb=346513, Db=217789 Eb*Db = 1 (mod p-1)
Bob: 1 шаг (1 блок): Получаем M^Ea = 710273 (mod p)
Bob: 2 шаг (1 блок): Отправляем M^Ea^Eb = 38836 (mod p)
Bob: 3 шаг (1 блок): Получаем M^Eb = 736896 (mod p)
Bob: 4 шаг (1 блок): Вычисляем M = 25939
Bob: 1 блок: Преобразуем M = 25939 в "Se"
--------------------------------------------------------------------------------
Bob: 2 блок: Генерируем Eb=782395, Db=783013 Eb*Db = 1 (mod p-1)
Bob: 1 шаг (2 блок): Получаем M^Ea = 615155 (mod p)
Bob: 2 шаг (2 блок): Отправляем M^Ea^Eb = 380094 (mod p)
Bob: 3 шаг (2 блок): Получаем M^Eb = 3710 (mod p)
Bob: 4 шаг (2 блок): Вычисляем M = 29283
Bob: 2 блок: Преобразуем M = 29283 в "cr"
--------------------------------------------------------------------------------
Bob: 3 блок: Генерируем Eb=497531, Db=52745 Eb*Db = 1 (mod p-1)
Bob: 1 шаг (3 блок): Получаем M^Ea = 112819 (mod p)
Bob: 2 шаг (3 блок): Отправляем M^Ea^Eb = 775152 (mod p)
Bob: 3 шаг (3 блок): Получаем M^Eb = 736285 (mod p)
Bob: 4 шаг (3 блок): Вычисляем M = 29797
Bob: 3 блок: Преобразуем M = 29797 в "et"
--------------------------------------------------------------------------------
Bob: 4 блок: Генерируем Eb=372229, Db=150151 Eb*Db = 1 (mod p-1)
Bob: 1 шаг (4 блок): Получаем M^Ea = 0 (mod p)
Bob: 2 шаг (4 блок): Отправляем M^Ea^Eb = 0 (mod p)
Bob: 3 шаг (4 блок): Получаем M^Eb = 0 (mod p)
Bob: 4 шаг (4 блок): Вычисляем M = 0
Bob: 4 блок: Преобразуем M = 0 в ""

## Дополнительные зависимости

module sympy
    можно установить командой (от администратора) pip3 install sympy
также этот сценарий лежит в файле dependencies.bat

## Кластер

Windows 10 Home Russian Версия 1809
Python 3.7.2 32bit
12GB RAM
Intel Core I7-4710MQ 2.50Ghz


## Автор

Кулаков Владислав Сергеевич КБ-501 ©

